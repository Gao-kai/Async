<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>高阶函数</title>
	</head>
	<body>
		<script type="text/javascript">
			/*
			 满足参数个数就是返回结果 链式调用
			 add(1)(2,3)(4)
			 */
			
			function add(a,b,c,d){
				return a+b+c+d;
			}
			
			function currying1(fn){
				// 第一次执行是[] 后续会持续缓存
				let cacheParams = Array.from(arguments).slice(1);
				// 如果要求fn函数传入的参数为0时执行
				return function Temp(...args){
					// 缓存本次传入的参数
					cacheParams = cacheParams.concat(args);
					if(args.length === 0){
						// 取出缓存的参数 执行并返回结果
						return fn.apply(null,cacheParams);
					}
					// 否则返回Temp引用并刷新cacheParams
					return Temp;
				}
				
			}
			
			function currying2(fn){
				// 第一次执行是[] 后续会持续缓存
				let cacheParams = Array.from(arguments).slice(1);
				// 如果要求fn函数传入的参数为0时执行
				return function Temp(...args){
					// 缓存本次传入的参数
					cacheParams = cacheParams.concat(args);
					
					// 如果缓存的参数个数已经大于等于fn函数的形参个数
					if(cacheParams.length >= fn.length){
						// 取出缓存的参数 执行并返回结果
						return fn.apply(null,cacheParams);
					}
					
					// 否则返回Temp引用并刷新cacheParams
					return Temp;
				}
				
			}
			
			add = currying2(add);
			add(1);
			add(2,3);
			add(4);
			console.log(add(4));
			
			var total = 0;
			function countMoney(money){
				total += money;
			}
			// countMoney(100);
			// countMoney(200);
			// countMoney(300);
			// console.log(total);
			
			countMoney = currying1(countMoney);
			countMoney(100);
			countMoney(200);
			countMoney(300);
			countMoney();
			console.log(total);
			
			
			function sum(){
				return Array.from(arguments).reduce((a,b)=>a+b);
			}
			
			// maxParamsLen指的是要柯里化的参数执行的最大参数个数
			function currying3(fn,maxParamsLen){
				// 除去fn,maxParamsLen两个参数
				let cacheParams = [];
				
				return function Temp(...innerArgs){
					// 保存每次进来的参数
					cacheParams = cacheParams.concat(innerArgs);
					// 参数满足条件就执行
					if(cacheParams.length >= maxParamsLen){
						return fn.apply(null,cacheParams);
					}
					// 返回Temp引用 但是外层cacheParams的值不变
					return Temp;
				}
			}
			// sum = currying3(sum,1);
			// console.log(sum(1));
			
			sum = currying3(sum,2);
			console.log(sum(2)(3));
			
		</script>
	</body>
</html>